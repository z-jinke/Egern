name: 网易云音乐
rules:
- or:
    name: 广告
    match:
    - domain:
        match: ipv6.music.163.com
    - domain:
        match: ipv4.music.163.com
    policy: REJECT
map_locals:
- match: ^https:\/\/(?:interface\d?)\.music\.163\.com\/(?:e?api|weapi)\/(?:delivery\/(?:batch-)?deliver|moment\/tab\/info|side-bar\/mini-program\/music-service\/account|yunbei\/account\/entrance|community\/friends\/fans-group\/artist\/group|mine\/applet\/redpoint|music\/songshare\/text\/recommend|resniche\/position\/play\/new|resniche\/tspopup\/show|resource\/comments?\/musiciansaid|user\/sub\/artist|ios\/version|mlivestream\/entrance\/playpage|link\/(?:position\/show\/strategy|scene\/show\/resource)|v1\/content\/exposure\/comment\/banner|activity\/bonus\/playpage\/time\/query|resource-exposure|search\/(?:chart|rcmd\/keyword|specialkeyword|default)|my\/podcast\/tab\/recommend|(?:ocpc\/)?ad)\/?
  status_code: 200
  body: ' '
scriptings:
- http_response:
    name: 广告处理
    match: ^https:\/\/(?:interface\d?)\.music\.163\.com\/eapi\/(?:batch|v2\/resource\/comment\/floor\/get|link\/position\/show\/resource)
    script_url: https://raw.githubusercontent.com/sooyaaabo/Loon/main/Script/NeteaseMusic/NeteaseMusicAds.js
    timeout: 10
    body_required: true
    binary_body: true
- http_response:
    name: 推荐处理
    match: ^https:\/\/(?:interface\d?)\.music\.163\.com\/eapi\/(?:homepage\/block\/page|link\/page\/rcmd\/(?:block\/resource\/multi\/refresh|resource\/show))
    script_url: https://kelee.one/Resource/JavaScript/NeteaseCloudMusic/NeteaseCloudMusic_remove_ads.js
    arguments:
      _compat.$argument: '{"PRGG":true,"PRST":true}'
    timeout: 10
    body_required: true
    binary_body: true
- http_response:
    name: 发现处理
    match: ^https:\/\/(?:interface\d?)\.music\.163\.com\/eapi\/link\/page\/discovery\/resource\/show
    script_url: https://kelee.one/Resource/JavaScript/NeteaseCloudMusic/NeteaseCloudMusic_remove_ads.js
    timeout: 10
    body_required: true
    binary_body: true
- http_response:
    name: 底栏处理
    match: ^https:\/\/(?:interface\d?)\.music\.163\.com\/eapi\/link\/home\/framework\/tab
    script_url: https://kelee.one/Resource/JavaScript/NeteaseCloudMusic/NeteaseCloudMusic_remove_ads.js
    arguments:
      _compat.$argument: '{"GZ":true,"DT":true}'
    timeout: 10
    body_required: true
    binary_body: true
mitm:
  hostnames:
    includes:
    - 'interface*.music.163.com'
